---
title: MATLAB基础知识
date: 2017-12-14 09:20:37
tags: MATLAB
categories: MATLAB
---

### MATLAB常用命令

1. cd 显示或改变当前工作文件夹

2. dir  显示当前文件夹或指定目录下的文件

3. clc 清除工作窗中的所有显示内容

4. clf 清除图形窗口

5. type 显示文件内容

6. disp 显示变量或文字内容

7. load 加载指定文件的变量

8. exit 退出MATLAB

9. quit 退出MATLAB

10. hold 图像保持开关

11. path 显示搜索目录

12. save  保存内存变量到指定文件

    <!--more-->

    ​

### MATLAB语言的标点

- ：冒号，具有多种应用功能
- ；分号，区分行及取消运算显示结果
- ，逗号，区分列及函数参数分隔符
- （） 括号，指定优先级
- [ ]  方括号，定义矩阵
- { } 大括号，构造单元数组
- % 百分号，注释标记
- ！ 惊叹号，调用操作运算符
- = 等号，赋值标记
- ‘ 单引号，字符串的标识符
- . 小数点及对象域访问
- ...  续行符号

### 函数句柄

创建函数句柄的一般句法格式为：

Function_Handle=@Function_Filename；

函数句柄的操作函数

functions(funhandle)

返回一个结构体，存储了函数的名称、函数类型（simple或overloaded），以及函数M文件的位置

func2str(funhandle)

将函数句柄装换为函数名称字符串

str2func(str)

将字符串代表的函数转换为函数句柄

save filename.mat funhandle

把*.mat文件中存储的函数句柄加载到工作区

isa(var,'function_handle')

检测变量var是否是函数句柄

isequal(funhandlea,funhandleb)

检测两个函数句柄是否对应同一个函数

### 函数

函数是可以定义输入参数或返回输出变量的M文件。M文件的名称和函数名称必须一致。从形式和句型格式上来看，函数文件的第一句总是以“function”所引导的“函数声明行”。

​     该行还会罗列该函数的所有“标称”的输入/输出的变量名称。函数文件对输入/输出的变量的数量并没有限制，可以完全没有输入/输出变量，也可以是任意数目的组合。

   与脚本文件不同的是，在MATLAB中，函数文件类似一个“黑匣子”，从外界无法看到其内部的运算流程，而只能看到其输入的参数的运算结果。这种函数文件的主要特点如下：

  （1）MATLAB在实现对函数的调用时，允许使用比“标称”数目更少的输入/输出变量。

  （2）从运行上看，与脚本文件运行不同的是，每当函数文件运行时，MATLAB就会专门为它打开一个临时的工作区（Context工作区），该空间也被称为函数工作区（Function工作区），函数运行中产生的所有中间变量都存放在函数工作区中。

​    每执行完文件最后一条指令或遇到return指令时，就结束该函数文件的执行，同时该临时的函数空间及其保存的所有中间变量就立即被清除。函数只执行自己工作区内的变量，对于超越工作范围的变量，则需要使用MATLAB命令提示符。



### M文件的一般结构

​      从结构上来看，脚本文件只是比函数文件少了一“函数声明行”，除此之外，二者的语法及结构均相同。于是将典型规范的M文件函数的结构总结如下：

　　（１）函数声明行：位于函数文件的首行，以ＭＡＴＬＡＢ关键字ｆｕｎｃｔｉｏｎ开头，定义函数名称的输入／输出变量，脚本文件无需函数声明行。

​         （2）H1行：紧随函数声明行之后的以“%”开头的第一注释行。H1行包括大写的函数文件名和运用关键词简要描述的函数功能。该函数提供lookfor命令作为作为关键词查询和help在线提供的使用。

   说明：

  （1）函数定义名应和文件保存名依次。当两者不一致时，MATLAB将忽视文件首行的函数定义名，而以文件保存名为准。

   （2）MATLAB中的函数文件名必须以字母开头，可以是字母，下划及数字的任意组合，但不可以超过31个字符。

  （3）在编写H1行注释时，尽量采用英文表达方式，这是为了之后的使用过程中关键词检索的方便。



### 内联函数

​       内联（inline）函数是MATLAB 7以前经常使用的一种构造函数对象的方法。在命令窗口、程序或函数中创建局部函数时，通过使用inline构造函数，而不用将其储存为一个M文件，同时又可以像使用一般函数那样调用它。

MATLAB中的内联函数借鉴了C语言中的内联函数，在C语言中，内联函数是通过编译器控制来实现的，它只在需要用到的时候，内联函数像宏一样的展开，所以取消了函数的参数压栈，减少了调用的时间和空间开销。在MATLAB中也有类似的性质。由于内联函数是储存于内存中而不是在M文件中，省去了文件访问的时间，加快了程序的运行效率。

虽然内联函数有M文件不具备的一些优势，但是由于内联函数的使用，也会受到一些制约。首先，不能在内联函数中调用另一个inline函数；另外，只能由一个MATLAB表达式组成，并且只能返回一个变量。

创建一个内联函数非常简单，就是使用inline方法，例如：

```matlab
>> f=inline('t^2-3*t-4')
f =
     Inline function:
     f(t) = t^2-3*t-4
```

MATLAB会通过检查字符串来推断自变量，例如上面的函数中t就是自变量，如果没有找到，将会使用x作为缺省的自变量，例如常数函数：

```matlab
>> g=inline('3')
g =
     Inline function:
     g(x) = 3
```

另外，对于inline也支持多元函数：

```matlab
>> h=inline('x+y')
h =
     Inline function:
     h(x,y) = x+y
```

这种创建方法等价于以下方法：

```matlab
>> h=inline('x+y','x','y')
```

这种方式显式地指定了参数列表。

使用内联函数也很简单，如同手写一般，以f(t) = t^2-3*t-4为例，分别计算在t=2和t=4时的函数值：

```matlab
>> f(2)
ans =
    -6
>> f(4)
ans =
     0
```

对于多元函数类似。

### **匿名函数**

​       匿名函数（anonymous function）是MATLAB 7.0版提出的一种全新的函数描述形式，和内联函数类似，可以让用户编写简单的函数而不需要创建M文件，因此，匿名函数具有inline函数的所有优点，并且效率比inline函数高，同时还具有一些独有的特点。

​       事实上匿名函数很像C语言中的宏，这个从匿名函数的构造就能够看得出来，但是它比宏的功能更加强大，就是可以支持变量替换，这将在后面的示例中有所体现。

匿名函数没有函数名，也不是函数M文件，只包含一个表达式和输入/输出参数。用户可以在命令行窗口中输入代码，创建匿名函数。匿名函数的创建方法：

f=@(input1,input2,.....)  expression

f 为创建的函数句柄。函数句柄是一种间接访问函数的途径，可以使用户调用函数变得简单，减少了程序设计中的繁杂，而且可以在执行函数调用过程中保存相关信息。

input1，input2等为输入变量，如果匿名函数没有输入参数，在调用函数时，需要用空格来替换input，否则MATLAB将不执行该程序，expression 为函数的主体表达式。

例如定义x和y的平方和函数：

```matlab
>> f=@(x,y) xx+yy
f =
    @(x,y)xx+yy
```

一旦定义了匿名函数，使用方式和inline函数类似，例如计算f(3,4)：

```matlab
>> f(3,4)
ans =
    25
```

前面提到，匿名函数可以使用工作空间的变量，例如创建函数f(x,y)=x^2+y^3：

```matlab
>> p=2;
>> q=3;
>> f=@(x,y) x^p+y^q
f =
    @(x,y)x^p+y^q
计算f(2,3)：
>> f(2,3)
ans =
    31
```

如果修改p或者q的值，例如将q改为2：

```matlab
q =
     2
>> f(2,3)
ans =
    31
```

计算结果并没有改变，这是因为，该函数句柄保存的是函数在创建时的快照，而不是动态的访问其中的变量，如果希望获取新值，需要重新创建一次该函数，完整的方法应该是这样的：

```matlab
>> q=2;
>> f=@(x,y) x^p+y^q
f =
    @(x,y)x^p+y^q
>> f(2,3)
ans =
    13
```

匿名函数会让前面的内联函数逐步退出MATLAB的舞台，事实上在设计这种类型的函数时就带有这一目的，但是为了保持程序的向下兼容，使用内联函数无疑将带来更好的兼容性。

### **函数函数**

​       函数函数（function function）是对传入的其他函数进行操作的函数，传入的函数作为函数函数的输入参数，传入到函数函数中的函数称为传递函数（Passed function），事实上MATLAB中就有许多这样的函数，例如求解常微分方程的函数ode23、ode45、ode113等都是函数函数，他们的第一个参数都是传递函数。另外一个常见的函数函数是fplot，用于绘制所提供函数的图形，语法为fplot(fun,lims)

例如绘制x取值范围为[-π,π]上f=sin(x)的图形：

```matlab
>> fplot(@sin,[-pi,pi])
```

和前面两种函数不同，函数函数是比较复杂的函数了，因此必须要保存在M文件中，例如可以编写一个计算某个传递函数在给定区间上最大值、最小值和平均值的函数函数：

```matlab
function [maxy,miny,aver]=fstatic(func,a,b,n)

    x=linspace(a,b,n);

    y=func(x);

    maxy=max(y);

    miny=min(y);

    aver=mean(y);

end

```

保存为M文件后，例如统计正弦函数在[-π,π]上的最大值、最小值和平均值：

```matlab
>> fstatic(@sin,-pi,pi,100)

ans =

    0.9999

>> [max min aver]=fstatic(@sin,-pi,pi,1000)

max =

    1.0000

min =

   -1.0000

aver =

 -5.9291e-018

```

### 子函数

在MATLAB中，多个函数的代码可以同时写到一个M函数文件中。其中，出现的第一个函数称为主函数，该文件中的其他函数称为子函数，保存时所用的函数文件名应当与主函数名相同，外部程序只能对主函数进行调用。

子函数的书写规范有如下几条：

1. 每个子函数的第一行是其函数声明行。
2. 在M函数文件中，主函数的位置不能改变，但是多个子函数的排列顺序可以任意改变。
3. 子函数只能被处于同一M文件中的主函数或其他子函数调用。
4. 同一M文件的主函数、子函数的工作区都是彼此独立的。各个函数间的信息传递可以通过输入/输出变量、全局变量或跨空间指令来实现。

### MATLAB 三维图形绘制

在实际工程应用中，常常遇到三维甚至更多维的数据，需要在图形中表示出来，MATLAB中提供了相应的三维图形 绘制功能，这些绘制功能与二维图形的绘制十分类似，特别是曲线的属性，例如线型、颜色等的设置，是完全相同的。最常用的三维绘图有三维曲线图、三维网格图和三维曲面图这3中基本类型，相应的MATLAB指令分别为plot3，mesh和surf。

1、曲线图绘制

在已经学习了plot指令的基础上，在三维图形指令中，plot3指令十分容易理解，其调用格式也与plot指令类似。其具体语法如下

plot3（x，y，z）：x，y，z为同维向量时，绘制以x，y，z为X，Y，Z坐标的三维曲线；x，y，z为同维矩阵时，用x，y，z的对应列元素绘制X，Y，Z坐标的三维曲线，曲线 的条数为                        矩  阵的列数。

plot3（x1,y1,z1,x2,y2,z2）;绘制以x1，y1，z1，和x2，y2，z2位X,Y,Z坐标的三维曲线

plot3（x，y，z，‘PropertyName’，PropertyValue.....）：在PropertyName所规定的曲线属性下，绘制三维曲线。

plot3（x1，y1，z1，‘ProtertyName1’，PropertyValue1...,x2,y2,z2,‘PropertyName2’，PropertyValue2....）;

示例：

 

```matlab
theta=0:0.01pi:2pi;

x=sin(theta);

y=cos(theta);

z=cos(4*theta);

figure

plot3(x,y,z,'LineWidth',2);

hold on;

theta=0:0.02pi:2pi;

>> x=sin(theta);

y=cos(theta);

z=cos(4*theta);

plot3(x,y,z,'rd','MarkerSize',10,'LineWidth',2)

```

![img](http://img.blog.csdn.net/20161226085128183)

例2：

```matlab
theta=0:0.01pi:2pi;

x1=sin(theta);

y1=cos(theta);

z1=cos(4*theta);

 x2=sin(2*theta);

 y2=cos(3*theta);

 z2=cos(5*theta);

 figure

plot3(x1,y1,z1,'rd',x2,y2,z2,'g^','LineWidth',2);

```

![img](http://img.blog.csdn.net/20161226085951559)

2.网格图绘制

三维网格图和曲面图的绘制比三维曲线图的绘制稍显复杂，主要是因为数据的准备及三维图形的色彩、明暗、光照和视角等的问题。绘制函数z=f（x，y）的三维网格图的过程如下：

（1）确定自变量x和y的取值范围和取值间隔

  x=x1：dx：x2， y=y1：dy：y2；

（2）构成xoy平面上的自变量采样”格点”矩阵。

​        法一：采用格点矩阵的原理生成矩阵

​                 x=x1：dx：x2， y=y1：dy：y2；

​               X=ones（size（y））*x；

​              Y=y*ones（size（x））；

​    法二： 采用meshgrid指令生成“格点”矩阵

​           x=x1：dx：x2， y=y1：dy：y2；

​          [X,Y]=meshgrid(x,y);

（3）计算在自变量采样“格点”上的函数值：Z=f（x，y）；

绘制网格图的基本mesh指令的语句的句法格式如下：

mesh（X,Y，Z）：以X为x轴自变量，Y为y轴自变量，绘制网格图；X，Y均为向量，若X，Y长度分别为m，n，则Z为mXn的矩阵，即[m,n]=size(Z),则网格线的顶点为  （Xj，Yi，Zi,j）。

mesh（Z）：以Z矩阵列下标为x轴自变量，行下标为y轴自变量，绘制网格图。

mesh（X，Y，Z，C）： 以X为x轴自变量，Y为y轴自变量，绘制网格图，其中C用于定义颜色， 如果不定义C，则成为mesh（X，Y，Z），其绘制的网格图的颜色随着Z值的变化（即曲面高度）而变化

mesh（X，Y，Z，‘PropertyName’，PropertyValue）：ProteryValue用来定义网格图的标记等属性。

示例：

![img](http://img.blog.csdn.net/20161226095358271)

3.曲面图的绘制

曲面图的绘制由surf指令完成，该指令的调用格式与mesh指令类似，具体如下：

surf（X,Y,Z）

surf（Z）

surf（X,Y,Z，C）

surf（X，Y，Z，‘PropertyName’，ProtertyValue）

mesh指令过绘制的图形是网格划分的曲面图，而surf指令绘制得到的是平滑着色的三维曲面图，着色的方式是在得到相应的网格点后，对每一个网格依据该网格所代表的节点的色值（由变量C控制）来定义这一网格的颜色。

![img](http://img.blog.csdn.net/20161226102133293)

![img](http://img.blog.csdn.net/20161226102145653)

4.光照模型

光照是一种利用方向光源照亮物体的技术，在某些情况下，这项技术能使表面微妙的差异更容易看到，光照也能用来对三维的图形增加现实感。

示例

```matlab
 x=-10:0.1:10;

y=-10:0.1:10;

 [X,Y]=meshgrid(x,y);

Z=-X.^2-Y.^2+200;

figure

surf(X,Y,Z,'FaceColor','red','EdgeColor','none');     %'FaceColor','red'曲面涂上红色，边缘无色

%一个发光的物体被加到了“镜头”的左边（即从空间观看时所在的表面的位置）

camlight left;

%设置照明方式为phong模型，

lighting phong          

%view命令改变视角 

 view(-15,65)

```

![img](http://img.blog.csdn.net/20161226103756738)

MATLAB中内置了surfl函数，可以画出类似于函数surf产生的带彩色的曲面，原理是基于运用漫反射、镜面发射光和环境照明模型。使用一个单色颜色映像（如灰色，纯白，铜黄或粉红色）和插值色彩，会画出效果更好的曲面，语法格式如下：

surfl（X,Y,Z,S）：其中S以[Sx,Sy,Sz]或[az,el]的形式定义光源方向，在没有定义的情况下，其默认光源是逆时针45度。

例：

```matlab
 [X,Y,Z]=peaks(30);      %峰函数，peaks（30）是产生30×30的guassian分布矩阵

subplot(1,2,1);

surfl(X,Y,Z)   

%colormap设定和获取当前色图的函数，colormap(copper)设定当前色图，copper 从黑色平滑过渡到亮铜色。

colormap(copper);

title('Default Lighting');

shading interp

%shading interp 会区分每个线形区域的颜色,并且插入与其相近的颜色。插值上色会极大地降低打印速度，

%这是因为每一个像素都有一个不同的颜色值，打印机对每个点要分别上色

subplot(1,2,2);surfl(X,Y,Z,[-90 30],[.55 .6 2 10]); 

%[-90 30]指定光源与曲面的方位，如果没有定义，默认光源是逆时针45度

%[0.55 0.5 2 10]指定反射系数，分别为环境光系数，漫反射系数，镜面反射系数，镜面发射亮度（以像素为单位）。缺省时默认为[0.55 0.6 0.4 0]

shading interp

```

![img](http://img.blog.csdn.net/20161226112538019)

5.绘制等值线图

等值线图又叫做等高线图，绘制等值线图需要用到contour指令，调用格式如下

contour（Z）：以Z矩阵列下标为x轴自变量，行下边为y轴自变量，绘制等值线图

contour(Z，n)：其中的n为所绘制的图形等值线的条数。

contour（Z,v）:其中的v为向量，向量的长度为等值线的条数，并且等值线的值为对应向量的元素值。

contour（X,Y,Z）：其功能为以X为x轴自变量，Y为y轴自变量，绘制等值线图；X,Y均为向量，若X，Y长度分别为m，n，则Z为mXn的矩阵，即[m,n]=size(Z)，则网格线的顶点为（Xj，Yi，Zij）。

contour（X，Y，Z，n）：其中的n为所绘制的图形等值线的条数。

contour（X，Y，Z，v）：其中的v为向量，向量的长度为等值线的条数，并且等值线的值为对应的向量的元素值。

contour（.....,'LineSpace'）:LineSpace用来定义等值线的线型。

与contour作用类似的指令还有contourf指令，其调用格式与contour相同。

例：

```matlab
[X,Y,Z]=peaks(30);
>> figure
>> subplot(2,2,1);contour(X,Y,Z);
>> subplot(2,2,2);contour(X,Y,Z,10);  %画出10条等值线
>> subplot(2,2,3);contour(X,Y,Z,-10:1:10); % 画出20条等值线，并且等值线的值为-10，-9，........,9,10
>> subplot(2,2,4);contour(X,Y,Z,':');  %  指定线型为点线
```

![img](http://img.blog.csdn.net/20161226115258498)

### Matlab四维图形可视化

1.颜色来表示第四维

前面已经学了三维图形可视化，所谓三维就是指x轴，y轴，z轴组成了我们的三维，那么第四维用什么来表示呢，我们这里要用颜色来表示第四维，所谓四维图形可视化就是在三维图形可视化的基础上，加上一个颜色维度，在三维图形可视化中我们也已经用到过颜色维度，mesh和surf等指令在绘制图像时，如果我们没有给出颜色参量的情况下，图形的颜色是沿着z轴的数据变化的。例如surf（X,Y,Z）和surf（X,Y,Z,Z）两个指令是相同的，在这里的颜色维度是和z轴的数据决定的，因为z轴已经纯在，颜色并不能给我们提供新的信息，所有这种所谓的颜色维度并不能算是第四维。我们可以使用不受3个轴影响的颜色来描述数据的某些属性，这才算是真正的第四维。我们只需要在三维作图的基础上给它加上不受3个轴影响的颜色参量作为第四维，这就是四维图形可视化。

颜色参量可以是任何实向量或与其他参量维数相同的矩阵。

示例

```matlab
 [X,Y,Z]=peaks(30);                          %峰函数，peaks（30）是产生30×30的guassian分布矩阵

R=sqrt(X.^2+Y.^2);                      %生成颜色参量

subplot(1,2,1);                            

surf(X,Y,Z,Z);                                      % surf(X,Y,Z)=surf(Z,Y,Z,Z);

axis tight                                      %调整坐标和你输入的数据范围一致

 subplot(1,2,2);surf(X,Y,Z,R);     %在三维绘图指令中加入新的颜色参量就编程了思维绘图函数了

axis tight                                      %调整坐标和你输入的数据范围一致

```

![img](http://img.blog.csdn.net/20161227084011595)

在左图中，第四维数据是Z，因为我们已经有Z了，这并不能算是真正的第四维。右图中，第四维数据是R，可以看到两幅图的颜色发生了明显变化。

2.其他函数

 除了surf函数外，mesh和pclolr函数也可以将第四维的数据附加到颜色属性上，并在图形中表示出来。

其他指令的句法和功能

句法格式                                          说明

surf（X,Y,Z，fun（X,Y,Z））       根据函数fun（X,Y,Z）来附加颜色数据

surf（X,Y,Z）=surf（X,Y,Z,Z）  默认动作，附加颜色数据与z轴

surf（X,Y,Z,X）                             附加颜色数据与x轴

surf（X,Y,Z,Y）                             附加颜色数据与y轴

surf（X,Y,Z,X.^2+Y.^2）               xoy平面上距远点一定的距离附加颜色数据

surf（X,Y,Z，del2（Z））          根据曲面的拉氏函数值附加颜色数据

[dZdx,dZdy]=gradient(Z);surf(X,Y,Z,abs(dZdz))   根据x轴方向的曲面斜率附加颜色数据

dz=sqrt（dZdx.^2+dZdy.^2）;surf(X,Y,Z,dz)    根据曲面斜率大小附加颜色数据